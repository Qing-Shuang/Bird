---
layout: default
tags: js
title: javascript 学习笔记(3)--执行环境与作用域
---

#javascript 学习笔记(3)--执行环境与作用域#

摘录于[《JavaScript高级程序设计:第2版》](http://book.douban.com/subject/4886879/)

##执行环境##

每个**执行环境**（execution context）都有一个与之关联的**变量对象**（variable object），环境中定义的所有变量和函数都保存在这个对象中。全局执行环境是最外围的一个执行环境。根据 ECMAScript 实现所在的宿主环境不同，表示执行环境的对象也不一样。

每个函数都有自己的执行环境。当执行流进入一个函数时，函数的环境就会被推入一个环境栈中。而在函数执行之后，栈将其环境弹出，把控制权返回给之前的执行环境。

当代码在一个环境中执行时，会创建变量对象的一个**作用域链**（scope chain）。作用域链的用途，是保证对执行环境有权访问的所有变量和函数的有权访问。作用域链的前端，始终都是当前执行的代码所在环境的变量对象。作用域链中的下一个变量对象来自包含（外部）环境，而再下一个变量对象则来自下一个包含环境。这样，一直延续到全局执行环境。

辨识符解析是沿着作用域链一级一级地搜索标识符的过程。如果找不到标识符，通常会导致错误发生。

		每个函数拥有自己的执行环境，执行环境拥有自己的变量对象，
		拥有一个包含着所有变量对象的作用域链的引用，
		不同的变量对象指向这个作用域链的不同节点（猜测）。

##延长作用域链##

* `try-catch` 语句的 `catch` 块
* `with` 语句

这些语句可以在作用域链的前端临时增加一个变量对象，该变量对象会在代码执行后被移除。对 `catch` 语句来说，该变量对象包含的是被抛出的错误对象的声明。而在 `with` 和 `catch` 语句中声明的变量都会被添加到所在执行环境的变量中，即下一个变量对象中。当执行流进入上列任何一个语句时，作用域链就会得到加长。

在 IE 中，即使是在 `catch` 块的外部也可以访问到捕获对象。

在任何位置，如果变量在未经声明的情况下被初始化，那么该变量会被自动添加到全局环境。





